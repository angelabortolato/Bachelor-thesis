c++ version of the rnn code
